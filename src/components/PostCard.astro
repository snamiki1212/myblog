---
import type { CollectionEntry } from "astro:content";
import { renderMeta } from "../utils/meta";
import { renderOnlyOneDate } from "../utils/date";
import { default as EditIcon } from "./EditIcon.astro";
import { default as IconUpdate } from "./IconUpdate.astro";

type BlogEntry = CollectionEntry<"blog">;
interface Props {
  entry: BlogEntry;
}

const toPostUrl = (entry: BlogEntry): string => `/${entry.slug}`;
const { entry } = Astro.props;
const category = entry.data.category;
const tags = entry.data.tags;
const { type, title: dateStr } = renderOnlyOneDate(entry);
---

<a
  href={toPostUrl(entry)}
  class="hover:-translate-y-1 transition-all duration-200"
>
  <div
    class="card card-compact hover:bg-base-100 max-w-xs h-48 bg-base-200 shadow-xl"
  >
    <div class="card-body">
      <h2 class="card-title pr-8">{entry.data.title}</h2>
      <div class="card-actions h-full flex items-end">
        <div class="flex flex-row flex-wrap justify-end gap-2 w-full">
          {
            tags.map((tag) => (
              <div class="badge badge-lg badge-outline normal-case">
                {renderMeta({ title: tag })}
              </div>
            ))
          }
        </div>
        <div class="flex flex-row justify-end items-center gap-2 w-full">
          <span>
            {type === "createdAt" ? <EditIcon /> : <IconUpdate />}
          </span>
          <span>
            {dateStr}
          </span>
        </div>
      </div>
    </div>
  </div>
</a>
